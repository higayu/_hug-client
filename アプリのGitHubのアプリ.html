<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Hug Client è‡ªå‹•ãƒªãƒªãƒ¼ã‚¹ãƒ»ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ‰‹é †æ›¸ï¼ˆPublicç‰ˆï¼‰</title>
  <style>
    body { font-family: "Segoe UI", sans-serif; line-height: 1.7; margin: 2em; color: #222; }
    h1, h2 { color: #005bbb; border-bottom: 2px solid #005bbb; padding-bottom: 4px; }
    pre, code { background: #f5f5f5; padding: 6px 10px; border-radius: 6px; }
    a { color: #007acc; text-decoration: none; }
    a:hover { text-decoration: underline; }
    ul { margin-left: 1em; }
    .note { background: #e8f4ff; padding: 10px; border-left: 4px solid #007acc; margin: 10px 0; }
  </style>
</head>
<body>

<h1>ğŸš€ Hug Client è‡ªå‹•ãƒªãƒªãƒ¼ã‚¹ãƒ»ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ‰‹é †æ›¸ï¼ˆPublicç‰ˆï¼‰</h1>

<h2>1ï¸âƒ£ æ¦‚è¦</h2>
<p>ã“ã®æ‰‹é †æ›¸ã¯ã€Electronã‚¢ãƒ—ãƒªã€Œ<strong>Hug Client</strong>ã€ã‚’ GitHub Public ãƒªãƒã‚¸ãƒˆãƒªã‚’åˆ©ç”¨ã—ã¦è‡ªå‹•ãƒªãƒªãƒ¼ã‚¹ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒˆãƒ¼ã‚¯ãƒ³ä¸è¦ã§è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹æ–¹æ³•ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚</p>

<div class="note">
  âœ… ãƒªãƒã‚¸ãƒˆãƒªï¼š<a href="https://github.com/higayu/hug-client" target="_blank">https://github.com/higayu/hug-client</a><br>
  âœ… å¯¾å¿œç’°å¢ƒï¼šWindows 10 / 11<br>
  âœ… ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ï¼šelectron-builder 26.x
</div>

<h2>2ï¸âƒ£ äº‹å‰æº–å‚™</h2>

<h3>â‘  ãƒªãƒã‚¸ãƒˆãƒªã®å…¬é–‹è¨­å®š</h3>
<p>GitHubã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ <strong>Publicï¼ˆå…¬é–‹ï¼‰</strong> ã«å¤‰æ›´ã—ã¦ãŠãã€‚</p>
<p>ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæƒ…å ±ï¼ˆ<code>latest.yml</code>ï¼‰ãŒèª°ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã«ãªã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¨å“¡ãŒè‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚</p>

<h3>â‘¡ ãƒˆãƒ¼ã‚¯ãƒ³è¨­å®šã¯ä¸è¦</h3>
<p>Publicãƒªãƒã‚¸ãƒˆãƒªã§ã¯ã€<strong>GH_TOKENã®è¨­å®šã¯ä¸è¦</strong>ã§ã™ã€‚  
electron-builder ã¯è‡ªå‹•çš„ã«GitHub Releasesã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚</p>

<h2>3ï¸âƒ£ package.jsonè¨­å®š</h2>

<pre><code>{
  "name": "hug-client",
  "version": "1.0.1",
  "main": "main.js",
  "scripts": {
    "start": "electron .",
    "dist": "electron-builder"
  },
  "dependencies": {
    "axios": "^1.12.2",
    "electron-log": "^5.4.3",
    "electron-updater": "^6.6.2",
    "sqlite3": "^5.1.6"
  },
  "devDependencies": {
    "electron": "^38.2.0",
    "electron-builder": "^26.0.12"
  },
  "build": {
    "appId": "com.example.hugclient",
    "productName": "Hug Client",
    "directories": {
      "output": "dist"
    },
    "files": [
      "main.js",
      "main/**/*",
      "preload.js",
      "renderer/**/*",
      "src/**/*",
      "package.json"
    ],
    "win": {
      "target": "nsis",
      "icon": "assets/favicon.ico"
    },
    "extraResources": [
      {
        "from": "data/",
        "to": "data/",
        "filter": ["**/*", "!config.json"]
      }
    ],
    "publish": {
      "provider": "github",
      "owner": "higayu",
      "repo": "hug-client",
      "private": false,
      "releaseType": "release"
    }
  }
}
</code></pre>

<div class="note">
  ğŸ”’ <code>config.json</code> ã¯åŒæ¢±ã•ã‚Œãšã€å¤–éƒ¨å…¬é–‹ã•ã‚Œã¾ã›ã‚“ã€‚<br>
  ğŸ”“ <code>private: false</code> ã«ã‚ˆã‚Šãƒˆãƒ¼ã‚¯ãƒ³ä¸è¦ã§å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°å¯èƒ½ã€‚<br>
  ğŸ†• åˆå›èµ·å‹•æ™‚ã« <code>config.json</code> ã¨ <code>ini.json</code> ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚
</div>

<h2>4ï¸âƒ£ main.jsï¼ˆè‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆè¨­å®šï¼‰</h2>

<pre><code>
// main.js
const { app, dialog } = require("electron");
const { autoUpdater } = require("electron-updater");
const log = require("electron-log");

// ğŸ”§ ãƒ‡ãƒãƒƒã‚°ç”¨ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆçŠ¶æ…‹ç®¡ç†
let updateDebugInfo = {
  isChecking: false,
  lastCheckTime: null,
  checkCount: 0,
  lastError: null,
  currentVersion: app.getVersion(),
  updateAvailable: false,
  downloadProgress: 0
};

// ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨ã—ã¦è¨­å®šï¼ˆIPCãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã«ã™ã‚‹ï¼‰
global.updateDebugInfo = updateDebugInfo;

autoUpdater.logger = log;
autoUpdater.logger.transports.file.level = "info";

app.whenReady().then(async () => {
  console.log("ğŸš€ [MAIN] Electronã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ã¾ã—ãŸ");

  // ğŸ”¹ 5ç§’å¾Œã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãƒã‚§ãƒƒã‚¯ï¼ˆGitHubé€šä¿¡ã®å®‰å®šåŒ–ã®ãŸã‚ï¼‰
  console.log("â° [UPDATE] 5ç§’å¾Œã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãƒã‚§ãƒƒã‚¯ã‚’é–‹å§‹ã—ã¾ã™...");
  setTimeout(() => {
    try {
      console.log("ğŸ”„ [UPDATE] ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãƒã‚§ãƒƒã‚¯é–‹å§‹");
      console.log("ğŸ”§ [UPDATE DEBUG] ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³:", app.getVersion());
      console.log("ğŸ”§ [UPDATE DEBUG] ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸çŠ¶æ…‹:", app.isPackaged ? "ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ¸ˆã¿" : "é–‹ç™ºä¸­");
      
      updateDebugInfo.isChecking = true;
      updateDebugInfo.lastCheckTime = new Date().toISOString();
      updateDebugInfo.checkCount++;
      
      autoUpdater.checkForUpdatesAndNotify();
    } catch (err) {
      console.error("âš ï¸ [UPDATE] ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãƒã‚§ãƒƒã‚¯å¤±æ•—:", err);
      updateDebugInfo.lastError = err.message;
      updateDebugInfo.isChecking = false;
    }
  }, 5000);

  const mainWindow = createMainWindow();
  globalTempNoteHandler = new TempNoteHandler();
  await globalTempNoteHandler.initDatabase();
  registerIpcHandlers(mainWindow, globalTempNoteHandler);
});

// ğŸ”§ è©³ç´°ãªã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼
autoUpdater.on("checking-for-update", () => {
  console.log("ğŸ” [UPDATE] ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆç¢ºèªä¸­...");
  updateDebugInfo.isChecking = true;
});

autoUpdater.on("update-available", (info) => {
  console.log("âœ… [UPDATE] ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆåˆ©ç”¨å¯èƒ½:", info);
  updateDebugInfo.updateAvailable = true;
  updateDebugInfo.newVersion = info.version;
});

autoUpdater.on("update-not-available", (info) => {
  console.log("â„¹ï¸ [UPDATE] ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãªã—ï¼ˆæœ€æ–°ç‰ˆï¼‰:", info);
  updateDebugInfo.updateAvailable = false;
  updateDebugInfo.isChecking = false;
});

autoUpdater.on("error", (err) => {
  console.error("âŒ [UPDATE] ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼:", err);
  updateDebugInfo.lastError = err.message;
  updateDebugInfo.isChecking = false;
});

autoUpdater.on("download-progress", (progressObj) => {
  const log_message = `ğŸ“¥ [UPDATE] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€²æ—: ${progressObj.percent}%`;
  console.log(log_message);
  updateDebugInfo.downloadProgress = progressObj.percent;
});

autoUpdater.on("update-downloaded", (info) => {
  console.log("âœ… [UPDATE] ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†:", info);
  updateDebugInfo.downloadComplete = true;
  
  const response = dialog.showMessageBoxSync({
    type: "info",
    title: "ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæº–å‚™å®Œäº†",
    message: `æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ${info.version} ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸã€‚ä»Šã™ãå†èµ·å‹•ã—ã¦æ›´æ–°ã—ã¾ã™ã‹ï¼Ÿ`,
    buttons: ["ä»Šã™ãå†èµ·å‹•", "å¾Œã§"]
  });
  if (response === 0) {
    console.log("ğŸ”„ [UPDATE] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†èµ·å‹•é–‹å§‹");
    autoUpdater.quitAndInstall();
  }
});
</code></pre>

---

<h2>5ï¸âƒ£ ãƒªãƒªãƒ¼ã‚¹æ‰‹é †</h2>

<h3>â‘  ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ›´æ–°</h3>
<pre><code>"version": "1.0.2"</code></pre>

<h3>â‘¡ ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ</h3>
<pre><code>npx electron-builder --win --publish always</code></pre>

<h3>â‘¢ æˆåŠŸæ™‚ã®å‡ºåŠ›ä¾‹</h3>
<pre><code>â€¢ publishing publisher=Github (owner: higayu, project: hug-client)
â€¢ uploading file=Hug-Client-Setup-1.0.2.exe provider=github
â€¢ uploaded Hug-Client-Setup-1.0.2.exe to GitHub
</code></pre>

---

<h2>6ï¸âƒ£ å…¬é–‹ç¢ºèª</h2>

<p>GitHub Releases ãƒšãƒ¼ã‚¸ï¼š</p>
<p><a href="https://github.com/higayu/hug-client/releases" target="_blank">
https://github.com/higayu/hug-client/releases
</a></p>

<p>æ¬¡ã®3ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Œã°OKï¼š</p>
<ul>
  <li><code>Hug-Client-Setup-1.0.2.exe</code></li>
  <li><code>Hug-Client-Setup-1.0.2.exe.blockmap</code></li>
  <li><code>latest.yml</code></li>
</ul>

---

<h2>7ï¸âƒ£ è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆå‹•ä½œç¢ºèª</h2>

<p>æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆä¾‹ï¼šv1.0.1ï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸPCã§ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã€  
ç´„5ç§’å¾Œã«ã€Œã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæº–å‚™å®Œäº†ã€ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒå‡ºã‚Œã°æˆåŠŸã§ã™ ğŸ‰</p>

<p><strong>ç¢ºèªURLï¼š</strong>  
<a href="https://github.com/higayu/hug-client/releases/latest/download/latest.yml" target="_blank">https://github.com/higayu/hug-client/releases/latest/download/latest.yml</a></p>

<h3>ğŸ”§ ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½</h3>
<p>ã‚¢ãƒ—ãƒªå†…ã®è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ã«ã€Œã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã€ã‚¿ãƒ–ãŒè¿½åŠ ã•ã‚Œã¦ãŠã‚Šã€ä»¥ä¸‹ã®æ©Ÿèƒ½ãŒåˆ©ç”¨ã§ãã¾ã™ï¼š</p>
<ul>
  <li>ğŸ“Š ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆçŠ¶æ…‹ã‚’è¡¨ç¤º</li>
  <li>ğŸ”„ æ‰‹å‹•ã§ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãƒã‚§ãƒƒã‚¯</li>
  <li>ğŸ“Š ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤º</li>
  <li>â° è‡ªå‹•ç›£è¦–ã®é–‹å§‹/åœæ­¢</li>
  <li>ğŸ“ è©³ç´°ãªãƒ­ã‚°è¡¨ç¤º</li>
</ul>

---

<h2>8ï¸âƒ£ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>
<ul>
  <li>ğŸ”¸ ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒå‡ºãªã„ â†’ æœ€æ–°ãƒªãƒªãƒ¼ã‚¹ãŒã€ŒDraftã€ã«ãªã£ã¦ã„ãªã„ã‹ç¢ºèª</li>
  <li>ğŸ”¸ <code>latest.yml</code> ãŒ404 â†’ ãƒªãƒã‚¸ãƒˆãƒªã‚’Publicã«è¨­å®šã—ãŸã‹ç¢ºèª</li>
  <li>ğŸ”¸ <code>config.json</code> ãŒå«ã¾ã‚Œã‚‹ â†’ <code>extraResources.filter</code> ã‚’å†ç¢ºèª</li>
  <li>ğŸ”¸ ã€Œupdate-downloadedã€ãŒå‡ºãªã„ â†’ <code>autoUpdater</code> ã®ãƒ­ã‚°ã‚’ç¢ºèªï¼ˆ<code>%APPDATA%/hug-client/logs/main.log</code>ï¼‰</li>
  <li>ğŸ”¸ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„ â†’ åˆå›èµ·å‹•æ™‚ã«è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€ã‚¢ãƒ—ãƒªã‚’å†èµ·å‹•</li>
  <li>ğŸ”¸ ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆçŠ¶æ…‹ãŒåˆ†ã‹ã‚‰ãªã„ â†’ è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã€Œã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã€ã‚¿ãƒ–ã§è©³ç´°ç¢ºèª</li>
  <li>ğŸ”¸ ãƒ‡ãƒãƒƒã‚°æƒ…å ±ãŒå¿…è¦ â†’ è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ« â†’ ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚¿ãƒ– â†’ ã€ŒğŸ“Š ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã€ãƒœã‚¿ãƒ³</li>
</ul>

<hr>
<p style="text-align:center;color:#666;">Â© 2025 Hug Client / Developer: higayu</p>

</body>
</html>
